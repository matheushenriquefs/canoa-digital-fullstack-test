$(document).ready(function(){var d=void 0;function c(e){var t=!0,a=!1,n=void 0;try{for(var o,i=e[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var s=o.value;$("#"+s).removeClass("border-success"),$("#"+s).removeClass("border-danger"),$("#"+s).removeClass("bg-white"),$("#"+s).removeAttr("placeholder"),$("#"+s).removeAttr("disabled"),$("#"+s).val(""),$("#"+s+"Text").removeClass("text-success"),$("#"+s+"Text").removeClass("text-danger"),$("#"+s+"Text").text("")}}catch(e){a=!0,n=e}finally{try{!t&&i.return&&i.return()}finally{if(a)throw n}}$("#inputVendidoNao").removeAttr("disabled"),$("#inputVendidoSim").removeAttr("disabled"),$("#inputVendidoNao").prop("checked",!0)}function t(e,t,a){var n=[];if("btnModalInfo"===a){for(var o in t)"id"!==o&&n.push(t[o]);for(var i=0;i<=e.length;i++)"Sim"===n[i]?($("#inputVendidoSim").removeAttr("disabled"),$("#inputVendidoSim").prop("checked",!0),$("#inputVendidoNao").attr("disabled","")):($("#inputVendidoNao").removeAttr("disabled"),$("#inputVendidoNao").prop("checked",!0),$("#inputVendidoSim").attr("disabled","")),$("#"+e[i]).attr("placeholder",n[i]),$("#"+e[i]).attr("disabled",""),$("#"+e[i]).addClass("bg-white")}else if("btnModalEditar"===a){var s=[];for(var r in t)"id"!==r&&"update_at"!==r&&s.push(t[r]);for(var l=0;l<=e.length;l++)"Sim"===s[l]?$("#inputVendidoSim").prop("checked",!0):$("#inputVendidoNao").prop("checked",!0),$("#"+e[l]).val(s[l])}}function u(){$("#dataTable").DataTable().ajax.reload(null,!1)}function p(e){var t=$("#"+e).val().trim().toUpperCase();return t.length<2?($("#"+e).removeClass("border-success"),$("#"+e+"Text").removeClass("text-success"),$("#"+e).addClass("border-danger"),$("#"+e+"Text").addClass("text-danger"),void $("#"+e+"Text").text("Nome curto demais")):2<=!t.length&&!new RegExp(/^[a-zA-Z\u00C0-\u00FF\0-9]*$/).test(t)?($("#"+e).removeClass("border-success"),$("#"+e+"Text").removeClass("text-success"),$("#"+e).addClass("border-danger"),$("#"+e+"Text").addClass("text-danger"),void $("#"+e+"Text").text("Nome inválido")):($("#"+e).removeClass("border-danger"),$("#"+e+"Text").removeClass("text-danger"),$("#"+e).addClass("border-success"),$("#"+e+"Text").addClass("text-success"),$("#"+e+"Text").text("Nome válido"),1)}function m(e){var t=parseInt($("#"+e).val().trim());return new RegExp(/^[1-9]\d{3}$/g).test(t)?($("#"+e).removeClass("border-danger"),$("#"+e+"Text").removeClass("text-danger"),$("#"+e).addClass("border-success"),$("#"+e+"Text").addClass("text-success"),$("#"+e+"Text").text("Ano válido"),1):($("#"+e).removeClass("border-success"),$("#"+e+"Text").removeClass("text-success"),$("#"+e).addClass("border-danger"),$("#"+e+"Text").addClass("text-danger"),void $("#"+e+"Text").text("Ano inválido"))}function v(e){var t=$("#"+e).val().trim();return 0===t.length?($("#"+e).removeClass("border-success"),$("#"+e+"Text").removeClass("text-success"),$("#"+e).addClass("border-danger"),$("#"+e+"Text").addClass("text-danger"),void $("#"+e+"Text").text("Descrição do veículo inválida, ela não pode estar vazia")):t.length<=9?($("#"+e).removeClass("border-success"),$("#"+e+"Text").removeClass("text-success"),$("#"+e).addClass("border-danger"),$("#"+e+"Text").addClass("text-danger"),void $("#"+e+"Text").text("Descrição do veículo inválida, ela deve conter mais de 10 caracteres")):($("#"+e).removeClass("border-danger"),$("#"+e+"Text").removeClass("text-danger"),$("#"+e).addClass("border-success"),$("#"+e+"Text").addClass("text-success"),$("#"+e+"Text").text("Descrição válida"),1)}$("#dataTable").DataTable({language:{url:"https://cdn.datatables.net/plug-ins/1.10.20/i18n/Portuguese-Brasil.json"},ajax:{url:"http://localhost:49152/veiculos",dataSrc:"",type:"GET",data:function(e){setTimeout(function(){$(".btnModalInfo").on("click",function(){$("#modalVeiculoLabel").text("Info veículo"),e.id=this.parentNode.parentNode.children[0].innerText,e.veiculo=this.parentNode.parentNode.children[1].innerText,e.marca=this.parentNode.parentNode.children[2].innerText,e.ano=this.parentNode.parentNode.children[3].innerText,e.descricao=this.parentNode.parentNode.children[4].innerText,e.vendido=this.parentNode.parentNode.children[5].innerText,d=e.id,t(["inputVeiculo","inputMarca","inputAno","inputDescricao"],e,"btnModalInfo")})},500),setTimeout(function(){$(".btnModalEditar").on("click",function(){$("#modalVeiculoLabel").text("Editar veículo"),$("#btnEditarVeiculo").removeClass("d-none"),$("#btnAdicionarVeiculo").addClass("d-none"),e.id=this.parentNode.parentNode.children[0].innerText,e.veiculo=this.parentNode.parentNode.children[1].innerText,e.marca=this.parentNode.parentNode.children[2].innerText,e.ano=this.parentNode.parentNode.children[3].innerText,e.descricao=this.parentNode.parentNode.children[4].innerText,e.vendido=this.parentNode.parentNode.children[5].innerText,d=e.id,t(["inputVeiculo","inputMarca","inputAno","inputDescricao"],e,"btnModalEditar")})},500),setTimeout(function(){$(".btnModalDeletar").on("click",function(){e.id=this.parentNode.parentNode.children[0].innerText,e.veiculo=this.parentNode.parentNode.children[1].innerText,e.marca=this.parentNode.parentNode.children[2].innerText,d=e.id,$("#marcaVeiculoText").text(e.marca.concat(" ",e.veiculo))})},500)}},columns:[{data:"_id",visible:!0,targets:0,render:function(e){return e}},{data:"veiculo",visible:!0,targets:1,className:"text-center compact nowrap",render:function(e){return e}},{data:"marca",visible:!0,targets:2,className:"text-center compact nowrap",render:function(e){return e}},{data:"ano",visible:!0,targets:3,className:"text-center",render:function(e){return e}},{data:"descricao",visible:!0,targets:4,className:"text-center text-truncate texto-descricao",render:function(e){return e}},{data:"vendido",visible:!0,targets:5,className:"text-center",render:function(e){return!1===e?"Não":"Sim"}},{data:"created_at",visible:!0,targets:6,className:"text-center",render:function(e){var t=new Date(e);return[t.getDate(),t.getMonth()+1,t.getFullYear()].join("/")}},{data:"update_at",visible:!0,targets:7,className:"text-center",render:function(e){var t=new Date(e);return[t.getDate(),t.getMonth()+1,t.getFullYear()].join("/")}},{data:"update_at",visible:!0,targets:8,className:"acoes text-center",render:function(){return'<button class="btn btn-info btn-icon-split btn-acoes mb-2 btnModalInfo" data-toggle="modal" data-target="#modalVeiculo"><span style="width: 2.5rem;" class="icon text-white"><i class="fas fa-info"></i></span><span class="text text-white">Info</span></button><button class="btn btn-warning btn-icon-split btn-acoes mb-2 btnModalEditar" data-toggle="modal" data-target="#modalVeiculo"><span style="width: 2.5rem;" class="icon text-white"><i class="fas fa-edit"></i></span><span class="text text-white">Editar</span></button><button class="btn btn-danger btn-icon-split btn-acoes btnModalDeletar" data-toggle="modal" data-target="#modalDeletarVeiculo"><span style="width: 2.5rem;" class="icon text-white"><i class="fas fa-trash"></i></span><span class="text text-white">Deletar</span></button>'}}]}),$("#dataTable").on("page.dt",function(){u()}),setTimeout(function(){var e=document.createElement("button"),t=document.createElement("span"),a=document.createElement("span"),n=document.createElement("i"),o=document.createElement("div"),i=Array.from(document.getElementsByTagName("label")),s=document.getElementsByTagName("th"),r=document.getElementById("dataTable_filter"),l=document.getElementById("dataTable_length"),d=r.children,c=document.getElementsByClassName("form-control")[1],u=document.getElementById("dataTable_wrapper").children[0];s[0].style.display="none",s[9].style.display="none",e.classList.add("btn","btn-success","btn-icon-split","mb-2"),e.style.height="2rem",e.setAttribute("id","btnModalAdicionar"),e.setAttribute("data-toggle","modal"),e.setAttribute("data-target","#modalVeiculo"),t.classList.add("icon","text-white"),a.classList.add("text","text-white"),a.innerText="Adicionar veículo",n.classList.add("fas","fa-plus"),o.classList.add("col-sm-12","col-md-4","pl-0","pr-0"),o.style.display="flex";var p=!0,m=!(o.style.justifyContent="center"),v=void 0;try{for(var $,f=i[Symbol.iterator]();!(p=($=f.next()).done);p=!0){$.value.classList.add("text-wrap")}}catch(e){m=!0,v=e}finally{try{!p&&f.return&&f.return()}finally{if(m)throw v}}i[0].childNodes[1].textContent=" Itens",r.parentElement.classList.add("pl-0"),r.parentElement.classList.remove("col-md-6"),r.parentElement.classList.add("col-md-4"),l.parentElement.classList.remove("col-md-6"),l.parentElement.classList.add("col-md-4"),d[0].childNodes[0].textContent="",c.classList.add("ml-0","w-100"),c.setAttribute("placeholder","Pesquisar"),e.appendChild(t),t.appendChild(n),e.appendChild(a),u.style.display="flex",u.style.alignItems="center",u.insertBefore(o,u.children[1]),o.appendChild(e),768<=screen.width&&(r.parentElement.classList.remove("pl-0"),o.style.display="flex",o.style.justifyContent="center")},500),$("#inputVeiculo").tooltip({trigger:"focus",title:"Um veículo válido NÃO deve conter caracteres especiais"}),$("#inputMarca").tooltip({trigger:"focus",title:"Uma marca válida NÃO deve conter caracteres especiais"}),$("#inputAno").tooltip({trigger:"focus",title:"Um ano válido NÃO deve conter letras, caracteres especiais ou números negativos"}),$("#inputDescricao").tooltip({trigger:"focus",title:"Faça uma breve descrição do veículo"}),setTimeout(function(){$("#btnModalAdicionar").on("click",function(){$("#modalVeiculoLabel").text("Adicionar veículo"),$("#btnAdicionarVeiculo").removeClass("d-none")}),$(".btnModalEditar").on("click",function(){$("#modalVeiculoLabel").text("Editar veículo"),$("#btnEditarVeiculo").removeClass("d-none")})},500),$("#btnDeletarVeiculo").on("click",function(e){var t;e.preventDefault(),t=d,$.ajax({url:"http://localhost:49152/veiculos/"+t,type:"DELETE"}).done(function(e){console.log("DELETE request successfully completed: STATUS 200"),$("#alertSuccessText").text(" O veículo foi removido"),$(".alert-success").css("display","initial"),$(".alert-success").addClass("show"),setTimeout(function(){$(".alert-success").removeClass("show")},3e3)}).fail(function(e){console.log("DELETE request failed: STATUS 500"),$("#alertDangerText").text(" O veículo não foi removido"),$(".alert-danger").css("display","initial"),$(".alert-danger").addClass("show"),setTimeout(function(){$(".alert-danger").removeClass("show")},3e3)}),$("#modalDeletarVeiculo").modal("hide"),$("#modalDeletarVeiculo").on("hidden.bs.modal",function(e){u()})}),$("#modalVeiculo").on("hidden.bs.modal",function(e){$("#btnAdicionarVeiculo").addClass("d-none"),$("#btnEditarVeiculo").addClass("d-none"),c(["inputVeiculo","inputMarca","inputAno","inputDescricao"])}),$("#inputVeiculo").on("keyup",function(){p("inputVeiculo")}),$("#inputVeiculo").on("focus",function(){p("inputVeiculo")}),$("#inputMarca").on("keyup",function(){p("inputMarca")}),$("#inputMarca").on("focus",function(){p("inputMarca")}),$("#inputAno").on("keyup",function(){m("inputAno")}),$("#inputAno").on("focus",function(){m("inputAno")}),$("#inputDescricao").on("keyup",function(){v("inputDescricao")}),$("#inputDescricao").on("focus",function(){v("inputDescricao")}),$(document).on("click","#btnAdicionarVeiculo",function(e){if(e.preventDefault(),p("inputVeiculo")&&p("inputMarca")&&m("inputAno")&&v("inputDescricao")){var t=$("#inputVeiculo").val().toUpperCase(),a=$("#inputMarca").val().toUpperCase(),n=parseInt($("#inputAno").val()),o=$("#inputDescricao").val().toUpperCase(),i=!1;$("#inputVendidoSim").is(":checked")&&(i=!0);var s=new Date,r=new Date;l={veiculo:t,marca:a,ano:n,descricao:o,vendido:i,created_at:s,update_at:r},$.ajax({url:"http://localhost:49152/veiculos/",type:"POST",data:JSON.stringify(l),contentType:"application/json"}).done(function(){console.log("POST request successfully completed: STATUS 200"),$("#alertSuccessText").text(" O veículo foi adicionado"),$(".alert-success").css("display","initial"),$(".alert-success").addClass("show"),setTimeout(function(){$(".alert-success").removeClass("show")},3e3)}).fail(function(){console.log("POST request failed: STATUS 500"),$("#alertDangerText").text(" O veículo não foi adicionado"),$(".alert-danger").css("display","initial"),$(".alert-danger").addClass("show"),setTimeout(function(){$(".alert-danger").removeClass("show")},3e3)}),$("#modalVeiculo").modal("hide"),$("#modalVeiculo").on("hidden.bs.modal",function(e){c(["inputVeiculo","inputMarca","inputAno","inputDescricao"]),u()})}var l}),$(document).on("click","#btnEditarVeiculo",function(e){if(e.preventDefault(),p("inputVeiculo")&&p("inputMarca")&&m("inputAno")&&v("inputDescricao")){var a=$("#inputVeiculo").val().toUpperCase(),n=$("#inputMarca").val().toUpperCase(),o=parseInt($("#inputAno").val()),i=$("#inputDescricao").val().toUpperCase(),s=!1;$("#inputVendidoSim").is(":checked")&&(s=!0);var r=(t=d,(l=$.ajax({url:"http://localhost:49152/veiculos/"+t,type:"GET"})).done(function(){console.log("GET request successfully completed: STATUS 200")}).fail(function(){console.log("POST request failed: STATUS 500")}),l);setTimeout(function(){r=new Date(r.responseJSON.created_at);var e,t=new Date;e={id:d,veiculo:a,marca:n,ano:o,descricao:i,vendido:s,created_at:r,update_at:t},$.ajax({url:"http://localhost:49152/veiculos/"+e.id,type:"PUT",data:JSON.stringify(e),contentType:"application/json"}).done(function(){console.log("PUT request successfully completed: STATUS 200"),$("#alertSuccessText").text(" O veículo foi atualizado"),$(".alert-success").css("display","initial"),$(".alert-success").addClass("show"),setTimeout(function(){$(".alert-success").removeClass("show")},3e3)}).fail(function(){console.log("PUT request failed: STATUS 500"),$("#alertDangerText").text(" O veículo não foi atualizado"),$(".alert-danger").css("display","initial"),$(".alert-danger").addClass("show"),setTimeout(function(){$(".alert-danger").removeClass("show")},3e3)})},1e3),setTimeout(function(){u()},1100),$("#modalVeiculo").modal("hide"),$("#modalVeiculo").on("hidden.bs.modal",function(e){c(["inputVeiculo","inputMarca","inputAno","inputDescricao"])})}var t,l}),setTimeout(function(){$("#wrapper").removeClass("d-none"),$("#spinner").addClass("d-none")},1500)});