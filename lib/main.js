$(document).ready(function(){var d=void 0;function l(e,t){var a=!0,i=!1,n=void 0;try{for(var o,r=e[Symbol.iterator]();!(a=(o=r.next()).done);a=!0){var s=o.value;$("#"+s).removeClass("border-success"),$("#"+s).removeClass("border-danger"),$("#"+s).val(""),$("#"+s+"Text").removeClass("text-success"),$("#"+s+"Text").removeClass("text-danger"),$("#"+s+"Text").text("")}}catch(e){i=!0,n=e}finally{try{!a&&r.return&&r.return()}finally{if(i)throw n}}$("#input"+t+"VendidoNao").prop("checked",!0)}function t(e,t,a){var i=[];if("Info"===a){for(var n in t)"id"!==n&&i.push(t[n]);for(var o=0;o<=e.length;o++)"Sim"===i[o]?($("#input"+a+"VendidoSim").removeAttr("disabled"),$("#input"+a+"VendidoSim").prop("checked",!0),$("#input"+a+"VendidoNao").attr("disabled","")):($("#input"+a+"VendidoNao").removeAttr("disabled"),$("#input"+a+"VendidoNao").prop("checked",!0),$("#input"+a+"VendidoSim").attr("disabled","")),$("#"+e[o]).attr("placeholder",i[o])}else if("Editar"===a){var r=[];for(var s in t)"id"!==s&&"update_at"!==s&&r.push(t[s]);for(var c=0;c<=e.length;c++)"Sim"===r[c]?$("#input"+a+"VendidoSim").prop("checked",!0):$("#input"+a+"VendidoNao").prop("checked",!0),$("#"+e[c]).val(r[c])}}function u(){$("#dataTable").DataTable().ajax.reload(null,!1)}function p(e){var t=$("#"+e).val().trim().toUpperCase();return t.length<2?($("#"+e).removeClass("border-success"),$("#"+e+"Text").removeClass("text-success"),$("#"+e).addClass("border-danger"),$("#"+e+"Text").addClass("text-danger"),void $("#"+e+"Text").text("Nome curto demais")):2<=!t.length&&!new RegExp(/^[a-zA-Z\u00C0-\u00FF\0-9]*$/).test(t)?($("#"+e).removeClass("border-success"),$("#"+e+"Text").removeClass("text-success"),$("#"+e).addClass("border-danger"),$("#"+e+"Text").addClass("text-danger"),void $("#"+e+"Text").text("Nome inválido")):($("#"+e).removeClass("border-danger"),$("#"+e+"Text").removeClass("text-danger"),$("#"+e).addClass("border-success"),$("#"+e+"Text").addClass("text-success"),$("#"+e+"Text").text("Nome válido"),1)}function m(e){var t=parseInt($("#"+e).val().trim());return new RegExp(/^[1-9]\d{3}$/g).test(t)?($("#"+e).removeClass("border-danger"),$("#"+e+"Text").removeClass("text-danger"),$("#"+e).addClass("border-success"),$("#"+e+"Text").addClass("text-success"),$("#"+e+"Text").text("Ano válido"),1):($("#"+e).removeClass("border-success"),$("#"+e+"Text").removeClass("text-success"),$("#"+e).addClass("border-danger"),$("#"+e+"Text").addClass("text-danger"),void $("#"+e+"Text").text("Ano inválido"))}function f(e){var t=$("#"+e).val().trim();return 0===t.length?($("#"+e).removeClass("border-success"),$("#"+e+"Text").removeClass("text-success"),$("#"+e).addClass("border-danger"),$("#"+e+"Text").addClass("text-danger"),void $("#"+e+"Text").text("Descrição do veículo inválida, ela não pode estar vazia")):t.length<=9?($("#"+e).removeClass("border-success"),$("#"+e+"Text").removeClass("text-success"),$("#"+e).addClass("border-danger"),$("#"+e+"Text").addClass("text-danger"),void $("#"+e+"Text").text("Descrição do veículo inválida, ela deve conter mais de 10 caracteres")):($("#"+e).removeClass("border-danger"),$("#"+e+"Text").removeClass("text-danger"),$("#"+e).addClass("border-success"),$("#"+e+"Text").addClass("text-success"),$("#"+e+"Text").text("Descrição válida"),1)}$("#dataTable").DataTable({language:{url:"https://cdn.datatables.net/plug-ins/1.10.20/i18n/Portuguese-Brasil.json"},ajax:{url:"http://localhost:49152/veiculos",dataSrc:"",type:"GET",data:function(e){setTimeout(function(){$(".btnModalInfo").on("click",function(){e.id=this.parentNode.parentNode.children[0].innerText,e.veiculo=this.parentNode.parentNode.children[1].innerText,e.marca=this.parentNode.parentNode.children[2].innerText,e.ano=this.parentNode.parentNode.children[3].innerText,e.descricao=this.parentNode.parentNode.children[4].innerText,e.vendido=this.parentNode.parentNode.children[5].innerText,d=e.id,t(["inputInfoVeiculo","inputInfoMarca","inputInfoAno","inputInfoDescricao"],e,"Info")})},500),setTimeout(function(){$(".btnModalEditar").on("click",function(){e.id=this.parentNode.parentNode.children[0].innerText,e.veiculo=this.parentNode.parentNode.children[1].innerText,e.marca=this.parentNode.parentNode.children[2].innerText,e.ano=this.parentNode.parentNode.children[3].innerText,e.descricao=this.parentNode.parentNode.children[4].innerText,e.vendido=this.parentNode.parentNode.children[5].innerText,d=e.id,t(["inputEditarVeiculo","inputEditarMarca","inputEditarAno","inputEditarDescricao"],e,"Editar")})},500),setTimeout(function(){$(".btnModalDeletar").on("click",function(){e.id=this.parentNode.parentNode.children[0].innerText,e.veiculo=this.parentNode.parentNode.children[1].innerText,e.marca=this.parentNode.parentNode.children[2].innerText,d=e.id,$("#marcaVeiculoText").text(e.marca.concat(" ",e.veiculo))})},500)}},ordering:!1,columns:[{data:"_id",visible:!0,searchable:!1,targets:0,className:"d-none",render:function(e){return e}},{data:"veiculo",visible:!0,targets:1,className:"text-center compact nowrap",render:function(e){return e}},{data:"marca",visible:!0,targets:2,className:"text-center compact nowrap",render:function(e){return e}},{data:"ano",visible:!0,targets:3,className:"text-center",render:function(e){return e}},{data:"descricao",visible:!0,targets:4,className:"text-center text-truncate texto-descricao",render:function(e){return e}},{data:"vendido",visible:!0,targets:5,className:"text-center",render:function(e){return!1===e?"Não":"Sim"}},{data:"created_at",visible:!0,targets:6,className:"text-center",render:function(e){var t=new Date(e);return[t.getDate(),t.getMonth()+1,t.getFullYear()].join("/")}},{data:"update_at",visible:!0,targets:7,className:"text-center",render:function(e){var t=new Date(e);return[t.getDate(),t.getMonth()+1,t.getFullYear()].join("/")}},{data:"update_at",visible:!0,searchable:!1,targets:8,className:"acoes text-center",render:function(){return'<button class="btn btn-info btn-icon-split btn-acoes mb-2 btnModalInfo" data-toggle="modal" data-target="#modalInfoVeiculo"><span style="width: 2.5rem;" class="icon text-white"><i class="fas fa-info"></i></span><span class="text text-white">Info</span></button><button class="btn btn-warning btn-icon-split btn-acoes mb-2 btnModalEditar" data-toggle="modal" data-target="#modalEditarVeiculo"><span style="width: 2.5rem;" class="icon text-white"><i class="fas fa-edit"></i></span><span class="text text-white">Editar</span></button><button class="btn btn-danger btn-icon-split btn-acoes btnModalDeletar" data-toggle="modal" data-target="#modalDeletarVeiculo"><span style="width: 2.5rem;" class="icon text-white"><i class="fas fa-trash"></i></span><span class="text text-white">Deletar</span></button>'}}]}),$("#dataTable").on("page.dt",function(){u()}),setTimeout(function(){var e,t,a=document.createElement("button"),i=document.createElement("span"),n=document.createElement("span"),o=document.createElement("i"),r=document.createElement("div"),s=Array.from(document.getElementsByTagName("label")),c=document.getElementById("dataTable_filter"),d=document.getElementById("dataTable_length"),l=c.children,u=document.getElementsByClassName("form-control")[1],p=document.getElementById("dataTable_wrapper").children[0];a.classList.add("btn","btn-success","btn-icon-split","mb-2"),a.style.height="2rem",a.setAttribute("id","btnModalAdicionar"),a.setAttribute("data-toggle","modal"),a.setAttribute("data-target","#modalAdicionarVeiculo"),i.classList.add("icon","text-white"),n.classList.add("text","text-white"),n.innerText="Adicionar veículo",o.classList.add("fas","fa-plus"),r.classList.add("col-sm-12","col-md-4","pl-0","pr-0"),$(r).css((e={display:"-webkit-box"},_defineProperty(e,"display","-ms-flexbox"),_defineProperty(e,"display","flex"),_defineProperty(e,"-webkit-box-pack","center"),_defineProperty(e,"-ms-flex-pack","center"),_defineProperty(e,"justify-content","center"),e));var m,f=!0,v=!1,x=void 0;try{for(var g,h=s[Symbol.iterator]();!(f=(g=h.next()).done);f=!0){g.value.classList.add("text-wrap")}}catch(e){v=!0,x=e}finally{try{!f&&h.return&&h.return()}finally{if(v)throw x}}s[0].childNodes[1].textContent=" Itens",c.parentElement.classList.add("pl-0"),c.parentElement.classList.remove("col-md-6"),c.parentElement.classList.add("col-md-4"),d.parentElement.classList.remove("col-md-6"),d.parentElement.classList.add("col-md-4"),l[0].childNodes[0].textContent="",u.classList.add("ml-0","w-100"),u.setAttribute("placeholder","Pesquisar"),a.appendChild(i),i.appendChild(o),a.appendChild(n),$(p).css((t={display:"-webkit-box"},_defineProperty(t,"display","-ms-flexbox"),_defineProperty(t,"display","flex"),_defineProperty(t,"-webkit-box-pack","center"),_defineProperty(t,"-ms-flex-pack","center"),_defineProperty(t,"justify-content","center"),t)),p.insertBefore(r,p.children[1]),r.appendChild(a),768<=screen.width&&(c.parentElement.classList.remove("pl-0"),$(r).css((m={display:"-webkit-box"},_defineProperty(m,"display","-ms-flexbox"),_defineProperty(m,"display","flex"),_defineProperty(m,"-webkit-box-pack","center"),_defineProperty(m,"-ms-flex-pack","center"),_defineProperty(m,"justify-content","center"),m)))},500),$("#inputAdicionarVeiculo").tooltip({trigger:"focus",title:"Um veículo válido NÃO deve conter caracteres especiais"}),$("#inputAdicionarMarca").tooltip({trigger:"focus",title:"Uma marca válida NÃO deve conter caracteres especiais"}),$("#inputAdicionarAno").tooltip({trigger:"focus",title:"Um ano válido NÃO deve conter letras, caracteres especiais ou números negativos"}),$("#inputAdicionarDescricao").tooltip({trigger:"focus",title:"Faça uma breve descrição do veículo"}),$("#inputEditarVeiculo").tooltip({trigger:"focus",title:"Um veículo válido NÃO deve conter caracteres especiais"}),$("#inputEditarMarca").tooltip({trigger:"focus",title:"Uma marca válida NÃO deve conter caracteres especiais"}),$("#inputEditarAno").tooltip({trigger:"focus",title:"Um ano válido NÃO deve conter letras, caracteres especiais ou números negativos"}),$("#inputEditarDescricao").tooltip({trigger:"focus",title:"Faça uma breve descrição do veículo"}),$("#modalAdicionarVeiculo").on("hidden.bs.modal",function(e){l(["inputAdicionarVeiculo","inputAdicionarMarca","inputAdicionarAno","inputAdicionarDescricao"])}),$("#modalEditarVeiculo").on("hidden.bs.modal",function(e){l(["inputEditarVeiculo","inputEditarMarca","inputEditarAno","inputEditarDescricao"])}),$("#inputAdicionarVeiculo").on("keyup",function(){p("inputAdicionarVeiculo")}),$("#inputAdicionarVeiculo").on("focus",function(){p("inputAdicionarVeiculo")}),$("#inputAdicionarMarca").on("keyup",function(){p("inputAdicionarMarca")}),$("#inputAdicionarMarca").on("focus",function(){p("inputAdicionarMarca")}),$("#inputAdicionarAno").on("keyup",function(){m("inputAdicionarAno")}),$("#inputAdicionarAno").on("focus",function(){m("inputAdicionarAno")}),$("#inputAdicionarDescricao").on("keyup",function(){f("inputAdicionarDescricao")}),$("#inputAdicionarDescricao").on("focus",function(){f("inputAdicionarDescricao")}),$("#inputEditarVeiculo").on("keyup",function(){p("inputEditarVeiculo")}),$("#inputEditarVeiculo").on("focus",function(){p("inputEditarVeiculo")}),$("#inputEditarMarca").on("keyup",function(){p("inputEditarMarca")}),$("#inputEditarMarca").on("focus",function(){p("inputEditarMarca")}),$("#inputEditarAno").on("keyup",function(){m("inputEditarAno")}),$("#inputEditarAno").on("focus",function(){m("inputEditarAno")}),$("#inputEditarDescricao").on("keyup",function(){f("inputEditarDescricao")}),$("#inputEditarDescricao").on("focus",function(){f("inputEditarDescricao")}),$(document).on("click","#btnAdicionarVeiculo",function(e){if(e.preventDefault(),p("inputAdicionarVeiculo")&&p("inputAdicionarMarca")&&m("inputAdicionarAno")&&f("inputAdicionarDescricao")){var t=$("#inputAdicionarVeiculo").val().trim().toUpperCase(),a=$("#inputAdicionarMarca").val().trim().toUpperCase(),i=parseInt($("#inputAdicionarAno").val()),n=$("#inputAdicionarDescricao").val().trim().toUpperCase(),o=!1;$("#inputAdicionarVendidoSim").is(":checked")&&(o=!0);var r=new Date,s=new Date;c={veiculo:t,marca:a,ano:i,descricao:n,vendido:o,created_at:r,update_at:s},$.ajax({url:"http://localhost:49152/veiculos/",type:"POST",data:JSON.stringify(c),contentType:"application/json"}).done(function(){console.log("POST request successfully completed: STATUS 200"),$("#alertSuccessText").text(" O veículo foi adicionado"),$(".alert-success").css("display","initial"),$(".alert-success").addClass("show"),setTimeout(function(){$(".alert-success").removeClass("show")},3e3)}).fail(function(){console.log("POST request failed: STATUS 500"),$("#alertDangerText").text(" O veículo não foi adicionado"),$(".alert-danger").css("display","initial"),$(".alert-danger").addClass("show"),setTimeout(function(){$(".alert-danger").removeClass("show")},3e3)}),$("#modalAdicionarVeiculo").modal("hide"),u(),$("#modalAdicionarVeiculo").on("hidden.bs.modal",function(e){l(["inputAdicionarVeiculo","inputAdicionarMarca","inputAdicionarAno","inputAdicionarDescricao"],"Adicionar")})}var c}),$(document).on("click","#btnEditarVeiculo",function(e){if(e.preventDefault(),p("inputEditarVeiculo")&&p("inputEditarMarca")&&m("inputEditarAno")&&f("inputEditarDescricao")){var a=$("#inputEditarVeiculo").val().trim().toUpperCase(),i=$("#inputEditarMarca").val().trim().toUpperCase(),n=parseInt($("#inputEditarAno").val()),o=$("#inputEditarDescricao").val().trim().toUpperCase(),r=!1;$("#inputEditarVendidoSim").is(":checked")&&(r=!0);var s=(t=d,(c=$.ajax({url:"http://localhost:49152/veiculos/"+t,type:"GET"})).done(function(){console.log("GET request successfully completed: STATUS 200")}).fail(function(){console.log("POST request failed: STATUS 500")}),c);setTimeout(function(){s=new Date(s.responseJSON.created_at);var e,t=new Date;e={id:d,veiculo:a,marca:i,ano:n,descricao:o,vendido:r,created_at:s,update_at:t},$.ajax({url:"http://localhost:49152/veiculos/"+e.id,type:"PUT",data:JSON.stringify(e),contentType:"application/json"}).done(function(){console.log("PUT request successfully completed: STATUS 200"),$("#alertSuccessText").text(" O veículo foi atualizado"),$(".alert-success").css("display","initial"),$(".alert-success").addClass("show"),setTimeout(function(){$(".alert-success").removeClass("show")},3e3)}).fail(function(){console.log("PUT request failed: STATUS 500"),$("#alertDangerText").text(" O veículo não foi atualizado"),$(".alert-danger").css("display","initial"),$(".alert-danger").addClass("show"),setTimeout(function(){$(".alert-danger").removeClass("show")},3e3)})},1e3),setTimeout(function(){u()},1100),$("#modalEditarVeiculo").modal("hide"),$("#modalEditarVeiculo").on("hidden.bs.modal",function(e){l(["inputEditarVeiculo","inputEditarMarca","inputEditarAno","inputEditarDescricao"])})}var t,c}),$("#btnDeletarVeiculo").on("click",function(e){var t;e.preventDefault(),t=d,$.ajax({url:"http://localhost:49152/veiculos/"+t,type:"DELETE"}).done(function(e){console.log("DELETE request successfully completed: STATUS 200"),$("#alertSuccessText").text(" O veículo foi removido"),$(".alert-success").css("display","initial"),$(".alert-success").addClass("show"),setTimeout(function(){$(".alert-success").removeClass("show")},3e3)}).fail(function(e){console.log("DELETE request failed: STATUS 500"),$("#alertDangerText").text(" O veículo não foi removido"),$(".alert-danger").css("display","initial"),$(".alert-danger").addClass("show"),setTimeout(function(){$(".alert-danger").removeClass("show")},3e3)}),u(),$("#modalDeletarVeiculo").modal("hide")}),setTimeout(function(){$("#wrapper").removeClass("d-none"),$("#spinner").addClass("d-none")},1e3)});
